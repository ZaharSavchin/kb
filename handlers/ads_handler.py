from aiogram import Router, F
from aiogram.types import Message

from config_data.config import admin_id

from database.database import users_db

from handlers.admin_handlers import bot
from config_data.logging_utils import logger

router = Router()


@router.message(F.text == 'bot send ads to users')
@logger.catch
async def send_ads(message: Message):
    counter = 0
    for user_id, name in users_db.copy().items():
        if "<" in name or ">" in name:
            name = name.replace(">", "&gt;").replace("<", "&lt;")
        try:
            await bot.send_message(chat_id=user_id,
                                   text=f'–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ <b>{name}</b>üëã\n\n'
                                        f'–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å—Å—ã–ª–æ–∫!\n\n'
                                        f'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ—Ç–æ–≤ (—è—á–µ–µ–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è)\n'
                                        f'<b>–û–¥–∏–Ω</b> —Å–ª–æ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å —á–∞—Å—Ç–æ—Ç–æ–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ–∫–æ–ª–æ <b>15 –º–∏–Ω—É—Ç</b>\n'
                                        f'<b>–í—Ç–æ—Ä–æ–π</b> —Å–ª–æ—Ç —Å—Ç–æ–∏—Ç 5 –±–µ–ª. —Ä—É–±. –≤ –º–µ—Å—è—Ü\n'
                                        f'<b>–ö–∞–∂–¥—ã–π</b> –ø–æ—Å–ª–µ–¥—É—é—â–∏–π 2.5 –±–µ–ª. —Ä—É–±. –≤ –º–µ—Å—è—Ü\n'
                                        f'–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ –ª—é–±–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª–æ—Ç–æ–≤ —á–∞—Å—Ç–æ—Ç–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å—Å—ã–ª–æ–∫ (–≤–∫–ª—é—á–∞—è –ø–µ—Ä–≤—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π) –æ–∫–æ–ª–æ <b>1 –º–∏–Ω—É—Ç—ã</b>\n\n'
                                        f'–°–ª–æ—Ç—ã –º–æ–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ <b>–ï–†–ò–ü</b>: –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏ > –ë–∞–Ω–∫–∏, –ù–ö–§–û > –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫ > –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—á–µ—Ç–∞ > +375298334964\n'
                                        f'–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞ <b>–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</b> (–ú–¢–°) +375(29)833-49-64\n'
                                        f'–ó–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å <b>—Å–∫—Ä–∏–Ω—à–æ—Ç —á–µ–∫–∞</b> –∏ —ç—Ç–æ —á–∏—Å–ª–æ (<b>{user_id}</b> - —ç—Ç–æ –í–∞—à id –≤ –±–æ—Ç–µ) —Å—é–¥–∞ >> @help_enot\n\n'
                                        f'–°–ª–æ—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ))',
                                   parse_mode='HTML'
                                   )
            counter += 1
        except Exception:
            await bot.send_message(chat_id=admin_id, text=f'{user_id}, {name} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')

    await bot.send_message(chat_id=admin_id, text=f'{counter} —Å–æ–æ–±—â–µ–Ω–∏–π –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ')



